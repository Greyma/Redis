# =====================================
# Configuration de base
# =====================================

# Lier Redis à une adresse IP spécifique (localhost par défaut)
bind 127.0.0.1

# Changer le port par défaut (6379) pour un autre port
port 6380

# Mot de passe pour accéder à Redis
requirepass votre-mot-de-passe-sécurisé

# Désactiver les commandes dangereuses
rename-command FLUSHALL ""
rename-command FLUSHDB ""
rename-command CONFIG ""
rename-command SHUTDOWN ""

# Activer le mode protégé (empêche l'accès sans mot de passe)
protected-mode yes

# =====================================
# Persistance des données
# =====================================

# Sauvegarder les données sur le disque (RDB)
save 900 1      # Sauvegarder après 900 secondes si au moins 1 clé a changé
save 300 10     # Sauvegarder après 300 secondes si au moins 10 clés ont changé
save 60 10000   # Sauvegarder après 60 secondes si au moins 10000 clés ont changé

# Activer AOF (Append-Only File) pour une persistance plus fiable
appendonly yes
appendfilename "appendonly.aof"

# =====================================
# Journalisation (logs)
# =====================================

# Activer les logs
loglevel notice

# Spécifier un fichier de log
logfile /var/log/redis/redis.log

# =====================================
# Limites de ressources
# =====================================

# Limiter la mémoire utilisée par Redis (par exemple, 1 Go)
maxmemory 1gb

# Politique d'éviction lorsque la mémoire est pleine
maxmemory-policy allkeys-lru

# =====================================
# Sécurité supplémentaire
# =====================================

# Désactiver l'accès à Redis depuis l'extérieur
protected-mode yes

# Limiter le nombre de clients connectés simultanément
maxclients 10000

# =====================================
# Options avancées
# =====================================

# Activer le mode démon (pour exécuter Redis en arrière-plan)
daemonize yes

# Désactiver la sauvegarde RDB si nécessaire
# save ""

# Désactiver AOF si nécessaire
# appendonly no